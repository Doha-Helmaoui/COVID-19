"use strict";var windowWidth=$(window).width(),desktopMin=768,WHOCms={verticalListHighlight:function(){$(".vertical-list--full-width").each(function(){$(this).addClass("flex-row"),$(this).children().first().addClass("vertical-list-item--highlight").wrapAll("<div class='flex-col flex-col-4'></div>"),$(this).children().not(":first-child").wrapAll("<div class='flex-col flex-col-8'></div>")})},movedNavigationSearchToHeader:function(){$(".top-header .navigation-search").length&&$(".top-header .navigation-search").clone().insertAfter(".main-header .header-logo")},searchOverlay:function(){var that=this,headerContainer=$(".main-header .container, .top-header .container"),navigationContainer=$(".navigation-search"),searchForm=$("#search-form"),searchInput=$(".searchInput");if(navigationContainer.length&&searchForm.length){headerContainer.find(".navigation-search").length||headerContainer.append(navigationContainer.clone(!0)),$(".search-overlay").length||($("#search-form").wrapAll('<div class="search-overlay"><div class="wrapper"></div></div>'),$(".search-overlay").prepend('<span class="closebtn">&times;</span>'));headerContainer.find(".navigation-search");$(document).on("click",".closebtn",function(){$("body").removeClass("search-open"),searchInput.val(" ")}),$(document).on("click",".navigation-search",function(){that.slideUpMainNavDropdown(),$(".search-open").length||$("body").addClass("search-open")}),$(document).on("click","#clear-search",function(){searchInput.val(" ")}),$(document).on("touchstart",".navigation-search",function(){that.slideUpMainNavDropdown(),searchInput.trigger("focus")})}},slideUpMainNavDropdown:function(){$(".navWrapper ul.nav").find(".open").removeClass("open"),$(".navWrapper .navItemLayout").slideUp(),$("body").removeClass("mainnav_overlay-visible")},setUpEqualHeight:function(){$(".row").each(function(){"function"==typeof matchHeight&&$.isFunction(matchHeight)&&$(this).find(".highlight-widget.title-and-summary").matchHeight()})},expandableList:function(){$("[data-sf-role=toggleLink]").on("click",function(){var link=$(this);link.find(".sf-icon");link.hasClass("expanded")?link.parent().removeClass("expanded"):link.parent().addClass("expanded")})},backgroundWidget:function(){var backgroundURLHolder=$(".background-url-holder");null!=backgroundURLHolder&&backgroundURLHolder.each(function(){var self=$(this),imageURL=self.find("img"),bgColor=self.attr("data-color");self.closest(".background-widget").addClass(bgColor);imageURL&&self.closest(".background-widget").addClass("bg-image")})},clickableHeroImage:function(){var heroImageContainer=$(".hero-image");void 0!=heroImageContainer&&(heroImageContainer.on("hover",function(){var url=$(this).attr("data-url");url&&""!==url&&$(this).css({cursor:"pointer"})}),heroImageContainer.on("click",function(){var url=$(this).attr("data-url"),target=$(this).attr("target");url&&""!==url&&window.open(url,target)}))},heroImageModernizr:function(){Modernizr.objectfit||$(".hero-image").each(function(){var $container=$(this),imgUrl=$container.find("img").prop("src");imgUrl&&$container.css("backgroundImage","url("+imgUrl+")").addClass("compat-object-fit")})},accordionNav:function(){$(".accordion-navigation .toggle").click(function(e){e.preventDefault();var $this=$(this);$this.next().hasClass("active")?($this.removeClass("active"),$this.next().removeClass("active"),$this.next().slideUp(350)):($this.removeClass("active"),$this.parent().parent().find("li .accordion-navigation--sublevel").removeClass("active"),$this.parent().parent().find("li .accordion-navigation--sublevel").slideUp(350),$this.parent().parent().find("li .toggle.active").removeClass("active"),$this.toggleClass("active"),$this.next().toggleClass("active"),$this.next().slideToggle(350))})},countMultimediaItems:function(){var multimediaRow=$(".multimedia-row"),multimediaRowItems=multimediaRow.children(),twoCols=$('<div class="sf_colsIn col-md-6"></div >'),threeCols=$('<div class="sf_colsIn col-md-4"></div >'),fourCols=$('<div class="sf_colsIn col-md-3"></div >');multimediaRowItems.length>=2&&(multimediaRow.addClass("visible"),$(".multimedia-row-heading").addClass("visible")),2===multimediaRowItems.length&&multimediaRow.each(function(){$(this).children().wrap(twoCols)}),3===multimediaRowItems.length&&multimediaRow.each(function(){$(this).children().wrap(threeCols)}),4===multimediaRowItems.length&&multimediaRow.each(function(){$(this).children().wrap(fourCols)})},initSelect2InDetailsPage:function(){$(".sf-detail-body-container select.sf-dropdown").each(function(){var select=$(this);select.select2({minimumResultsForSearch:-1,placeholder:function(){$(this).data("placeholder")}}),select.on("select2:selecting",function(e){window.location=e.params.args.data.id})})},initYouTubeVideoPlayer:function(){$(".player").length&&setTimeout(function(){$(".player").mb_YTPlayer()},1e3)},removeEmptyColumns:function(){$(".sf_colsIn").each(function(){0==$.trim($(this).text()).length&&0==$(this).children().length&&($(this).text(""),$(this).addClass("empty"))})},gridMatchHeights:function(){$(".matching-height").each(function(){$(".matching-height--item").matchHeight()})},formsSelect2Dropdown:function(){$("[data-sf-role='dropdown-list-field-container'] select").select2({containerCssClass:"sf-forms-dropdown-container",dropdownCssClass:"sf-forms-dropdown-list"})},formsFileUploadLabel:function(){$('input[type="file"]').each(function(){$(this).change(function(e){var fileName=e.target.files[0].name,label=$(".file-input-name");label.empty(),label.append(fileName)})})},mainNavAZlistFilterHTList:function(){var azListInMainNav=$(".a-z--list"),hashUrlValue=""!=window.location.hash?window.location.hash.split("#")[1]:"",triggerLetter=function(letter){var lowerCaseLetter=letter.toString().toLowerCase();$(".ln-letters").length&&$(".ln-letters a"+lowerCaseLetter)?($(".ln-letters a"+lowerCaseLetter).trigger("click"),$("html,body").animate({scrollTop:$(".ln-letters").offset().top},1e3)):$(".ln-letters a.all").trigger("click")};azListInMainNav.find("li a").click(function(){var linkHref=$(this).html();triggerLetter(linkHref)}),""!=hashUrlValue&&triggerLetter(hashUrlValue)},healhTopiclistMainNavScroll:function(){var filteredListItem=$("#alphabetical-nav-filter-nav").find(".ln-selected").not(".all");filteredListItem.length&&setTimeout(function(){$("html,body").animate({scrollTop:filteredListItem.offset().top-50},1e3)},1e3)},moreContent:function(){$("div[data-class]").each(function(){var self=$(this),dataClassVal=self.data("class");"more-content"===dataClassVal&&self.addClass("more-content"),"more-content-inner"===dataClassVal&&self.addClass("more-content-inner"),"more-button"===dataClassVal&&self.addClass("more-button"),"more-button-label"===dataClassVal&&(self.addClass("more-button-label"),self.find("text")[0]&&self.attr("data-close",self.find("text")[0].innerHTML),self.find("text")[1]&&self.attr("data-open",self.find("text")[1].innerHTML))});var moreButton=$(".more-button"),moreContent=$(".more-content");moreButton.on("click",function(){var self=$(this),moreContent=self.prev(),moreContentInner=moreContent.find(".more-content-inner");self.hasClass("open")?(moreContent.height(0),self.removeClass("open"),moreContent.removeClass("visible")):(moreContent.height(moreContentInner.height()),self.addClass("open"),moreContent.addClass("visible"))});for(var x=moreContent.filter(".visible"),y=0;y<x.length;y++)$(x[y]).height($(x[y]).find(".more-content-inner").height())},imageCredit:function(){for(var that=this,credit=$(".sf-image-credit"),creditContent=$(".sf-image-credit__content"),creditTriggerLabel=$(".sf-image-credit__label"),x=creditContent.filter(".visible"),y=0;y<x.length;y++)$(x[y]).height($(x[y]).find(".sf-image-credit__inner").innerHeight());$(".sf-image-credit").each(function(){var _self=$(this),creditContent=_self.find(".sf-image-credit__content"),creditInner=_self.find(".sf-image-credit__inner"),creditTriggerLabel=_self.find(".sf-image-credit__label");_self.show(),creditTriggerLabel.on("click",function(){creditContent.hasClass("visible")?(creditContent.height(0),creditContent.removeClass("visible"),$(this).removeClass("active"),_self.removeClass("expanded")):(creditContent.addClass("visible"),$(this).addClass("active"),_self.addClass("expanded"),creditContent.height(creditInner.innerHeight()))})}),$(window).resize(function(){$(window).width();credit.hasClass("expanded")&&(creditContent.height(0),creditContent.removeClass("visible"),creditTriggerLabel.removeClass("active"),credit.removeClass("expanded")),that.imageCreditBreakpointClass()})},imageCreditBreakpointClass:function(){$(".sf-image-credit").each(function(){var _self=$(this),_selfContainterWidth=_self.closest('div[class*="col-"]').width();null!=_selfContainterWidth&&(_self.removeClass("desktop-medium desktop tablet mobile-large mobile"),_selfContainterWidth>=1280&&_self.addClass("desktop-medium"),_selfContainterWidth>=1020&&_selfContainterWidth<1280&&_self.addClass("desktop"),_selfContainterWidth>=768&&_selfContainterWidth<1020&&_self.addClass("tablet"),_selfContainterWidth>=600&&_selfContainterWidth<768&&_self.addClass("mobile-large"),_selfContainterWidth<600&&_self.addClass("mobile"))})},initTabs:function(){if(void 0===window.tabsJs){window.tabsJs=!0;var script=document.createElement("script");script.setAttribute("type","text/javascript"),script.setAttribute("src","/ResourcePackages/WHO/assets/dist/scripts/gridTabs.min.js"),document.body.appendChild(script)}},initStepTabs:function(){if(void 0===window.stepTabs){window.stepTabs=!0;var script=document.createElement("script");script.setAttribute("type","text/javascript"),script.setAttribute("src","/ResourcePackages/WHO/assets/dist/scripts/step-tabs.min.js"),document.body.appendChild(script)}},trimTextToContainer:function(){function trimTitles(){containers.forEach(function(container){var fullTitle=container.querySelector(hiddenSelector),span=container.querySelector(elToTrimSelector);if(span&&fullTitle){span.textContent=fullTitle.textContent;for(var titleHeight=container.clientHeight;span.offsetHeight>titleHeight&&span.textContent.length>30;)span.textContent=span.textContent.replace(/\W*\s(\S)*$/,"...")}})}var containers=document.querySelectorAll(".sf-list-vertical__title"),hiddenSelector=".full-title",elToTrimSelector=".trimmed";trimTitles(),window.addEventListener("resize",trimTitles)},init:function(){$(function(){$("img.lazy").lazy({effect:"fadeIn",effectTime:2e3,threshold:0})}),this.gridMatchHeights(),this.searchOverlay(),this.setUpEqualHeight(),this.verticalListHighlight(),this.expandableList(),this.backgroundWidget(),this.clickableHeroImage(),this.heroImageModernizr(),this.accordionNav(),this.movedNavigationSearchToHeader(),this.initSelect2InDetailsPage(),this.countMultimediaItems(),this.initYouTubeVideoPlayer(),this.removeEmptyColumns(),this.formsSelect2Dropdown(),this.formsFileUploadLabel(),this.healhTopiclistMainNavScroll(),this.moreContent(),this.imageCredit(),this.imageCreditBreakpointClass(),this.initTabs(),this.initStepTabs(),this.trimTextToContainer()}};$(function(){WHOCms.init()});var pubSubEvents=function(){var subscribers={hubsUpdate:[]};return{publish:function(eventName,data){subscribers[eventName]&&subscribers[eventName].forEach(function(subscriberCallback){subscriberCallback(void 0!=data?data:{})})},subscribe:function(eventName,callback){return subscribers[eventName]||(subscribers[eventName]=[]),subscribers[eventName].push(callback),{unsubscribe:function(){subscribers[eventName].splice(index,1)}}}}}();